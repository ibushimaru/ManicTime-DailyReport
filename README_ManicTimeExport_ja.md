# ManicTime アプリケーション使用状況エクスポート自動化ツール

## 概要
このツールは、ManicTimeのアプリケーション使用状況を本日分だけCSV形式で自動エクスポートするPythonスクリプトです。

---

## 必要な環境
- Windows 10 以降
- Python 3.7 以降（64bit推奨）
- ManicTime（CLIエクスポート機能が必要）
- ManicTimeがインストールされていること

---

## 使い方
1. `export_today_applications.py` を任意のフォルダに配置します。
2. ManicTimeが起動していることを確認してください。
3. コマンドプロンプトまたはPowerShellを「管理者として実行」します。
4. 以下のコマンドでスクリプトを実行します：
   ```
   python export_today_applications.py
   ```
5. エクスポートされたCSVファイルは、デスクトップの `ManicTimeExports` フォルダに保存されます。

---

## 管理者権限での実行方法

### ショートカットを使う場合
1. デスクトップ上で右クリックし、「新規作成」→「ショートカット」を選択。
2. 「項目の場所を入力してください」に以下を入力：
   python "C:\Users\ibushi maru\Desktop\作業ファイル\ManicTimeTest\export_and_report.py"
3. 「次へ」をクリックし、ショートカットの名前を入力（例：ManicTimeエクスポート実行）。
4. 作成したショートカットを右クリックし、「プロパティ」を選択。
5. 「ショートカット」タブの「詳細設定」ボタンをクリック。
6. 「管理者として実行」にチェックを入れて「OK」。
7. 「OK」でプロパティ画面を閉じる。

これで、作成したショートカットをダブルクリックすると、管理者権限でPythonスクリプトが実行されます。

---

- スタートメニューで「cmd」または「PowerShell」と入力し、右クリック→「管理者として実行」を選択しても実行できます。

---

## よくあるトラブルと対策
- **エクスポート時に「Access to the path is denied.」と表示される**
  - 管理者権限で実行してください。
  - ManicTimeのライセンスがCLIエクスポートに対応しているか確認してください。
- **Pythonが見つからない/コマンドが通らない**
  - Pythonのインストールとパス設定を確認してください。
- **ManicTimeが起動していない/データが出力されない**
  - ManicTime本体がバックグラウンドで動作しているか確認してください。
- **エクスポート先フォルダが作成されない**
  - スクリプトは自動で作成しますが、権限不足の場合は手動で作成してください。

---

## 注意事項
- ManicTimeの無料版ではCLIエクスポート機能が制限されている場合があります。
- スクリプト内の `mtc_path`（Mtc.exeのパス）は、ManicTimeのインストール場所によって異なります。
- 標準インストールの場合：
  - 64bit版: `C:\Program Files\ManicTime\Mtc.exe`
  - 32bit版: `C:\Program Files (x86)\ManicTime\Mtc.exe`
- カスタムインストールの場合は、インストール時に指定したパスを確認してください。
- パスが異なる場合は、スクリプト先頭の `mtc_path` 変数をテキストエディタで修正してください。
- パスが不明な場合は、エクスプローラーで `Mtc.exe` を検索し、右クリック→「ファイルの場所を開く」で確認できます。
- エクスポート先やファイル名の仕様を変更したい場合は、スクリプト内の該当箇所を編集してください。

---

## サポート
ご不明点があれば、ManicTime公式ドキュメント（https://docs.manictime.com/win-client/cli）もご参照ください。 